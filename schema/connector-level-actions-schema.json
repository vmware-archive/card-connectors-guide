{
  "$schema": "http://json-schema.org/schema#",
  "title": "Connector-level action schema",

  "type": "array",
  "items": {"$ref": "#/definitions/connectorAction"},
  "additionalProperties": false,

  "definitions": {

    "link": {
      "type": "object",
      "properties": {
        "href": {"type": "string", "format": "uri"}
      },
      "required": ["href"],
      "additionalProperties": false
    },

    "connectorAction": {
      "type": "object",
      "properties": {
        "action_key": {"type": "string", "description": "An arbitrary string used by the client to distinguish this action from other actions that may be sent"},
        "label":      {"type": "string", "description": "A human-readable description of the action"},
        "url":        {"$ref": "#/definitions/link", "description": "Link to the action"},
        "type":       {"$ref": "#/definitions/httpMethods", "description": "The HTTP method to use for submitting the action request"},
        "user_input": {
          "type": "array",
          "items": {"$ref": "#/definitions/connectorActionUserInput"},
          "description": "Allows the user to enter data to be submitted in this action"
        },
        "request": {
          "type": "object",
          "description": "Fields to be sent with the action request",
          "properties": {
            "env": {
              "type": "string",
              "description": "Environment variable to send in the request.  See Discovery in wiki"
            }
          }
        }
      },
      "required": ["action_key", "label", "url", "type"],
      "additionalProperties": false
    },

    "connectorActionUserInput": {
      "type": "object",
      "properties": {
        "id":         {"type": "string", "description": "The field's ID, which will be used as the key when this field is submitted"},
        "label":      {"type": "string", "description": "The field's label, which will be displayed to the user to describe the expected content of the field"},
        "format":     {"type": "string", "description": "The type of the user input"},
        "options":    {"type": "object", "description": "Options to present when format is select."},
        "min_length": {"type": "integer", "minimum": 0, "description": "The minimum length of the field"},
        "max_length": {"type": "integer", "minimum": 0, "description": "The maximum length of the field"}
      },
      "required": ["id", "label"],
      "additionalProperties": false
    },

    "httpMethods": {
      "type": "string",
      "enum": ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"]
    }
  }
}
